name: Ø¨Ù†Ø§Ø¡ ØªØ·Ø¨ÙŠÙ‚ Ø£Ù†Ø¯Ø±ÙˆÙŠØ¯

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  build-android:
    runs-on: ubuntu-latest
    
    steps:
    - name: ğŸ“¥ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙƒÙˆØ¯
      uses: actions/checkout@v3
    
    - name: ğŸ—ï¸ Ø¥Ø¹Ø¯Ø§Ø¯ Ø¨ÙŠØ¦Ø© Ø§Ù„Ø¨Ù†Ø§Ø¡
      run: |
        sudo apt-get update
        sudo apt-get install -y nodejs npm default-jdk
        sudo npm install -g cordova
    
    - name: ğŸ”§ ØªØ«Ø¨ÙŠØª Ù…ØªØ·Ù„Ø¨Ø§Øª Cordova
      run: |
        npm install -g cordova
        cordova telemetry off
    
    - name: ğŸ› ï¸ Ø¨Ù†Ø§Ø¡ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
      run: |
        python3 build.py
    
    - name: ğŸ“¦ Ø±ÙØ¹ APK ÙƒÙ€ Artifact
      uses: actions/upload-artifact@v3
      with:
        name: emad-accounting-apk
        path: emad-accounting.apk
    
    - name: ğŸš€ Ø¥Ù†Ø´Ø§Ø¡ Release
      if: github.event_name == 'push' && github.ref == 'refs/heads/main'
      uses: softprops/action-gh-release@v1
      with:
        files: emad-accounting.apk
        tag_name: v1.0.0
        name: "ØªØ·Ø¨ÙŠÙ‚ Ø¹Ù…Ø§Ø¯ Ø§Ù„Ù…Ø­Ø§Ø³Ø¨ÙŠ v1.0.0"
        body: |
          ØªØ·Ø¨ÙŠÙ‚ Ø£Ù†Ø¯Ø±ÙˆÙŠØ¯ Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø­Ø§Ø³Ø¨Ø©
          
          Ø§Ù„Ù…Ù…ÙŠØ²Ø§Øª:
          - Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡
          - Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª
          - Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª ÙˆØ§Ù„ÙÙˆØ§ØªÙŠØ±
          - Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±
